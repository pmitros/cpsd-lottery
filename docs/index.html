<!DOCTYPE HTML>
<html lang="en">
  <head>
      <title>CPSD School Lottery</title>
      <link rel="stylesheet" href="lib/bootstrap.min.css">
      <link crossorigin="anonymous" href="css/new.css" rel="stylesheet" />
      <meta charset="UTF-8">
  </head>
  <body>
    <div>
      <nav class="navbar navbar-inverse" role="navigation" style="padding-left:130px;">
	<ul class="nav navbar-nav">
	  <li class="nav-top-tab" id="home-tab"><a href="#">Home</a></li>
	  <li class="nav-top-tab" id="school-tab" class="dropdown">
	    <a class="header dropdown-toggle external" data-toggle="dropdown" role="button" href="/">School Choices<span class="caret"></span></a>
	    <ul class="dropdown-menu" role="menu">
	      <li><a class="external" href="#amigos">Amigos</a></li>
	      <li><a class="external" href="#baldwin">Baldwin</a></li>
	      <li><a class="external" href="#cambridgeport">Cambridgeport</a></li>
	      <li><a class="external" href="#mlk">Dr. MLK</a></li>
	      <li><a class="external" href="#mlk-ci">Chinese Immersion (at Dr. MLK)</a></li>
	      <li><a class="external" href="#fma">Fletcher Maynard</a></li>
	      <li><a class="external" href="#grahamandparks">Graham & Parks</a></li>
	      <li><a class="external" href="#haggerty">Haggerty</a></li>
	      <li><a class="external" href="#klo">Kennedy-Longfellow</a></li>
	      <li><a class="external" href="#kingopen">King Open</a></li>
	      <li><a class="external" href="#morse">Morse</a></li>
	      <li><a class="external" href="#kingopen-ola">Ola Portugese Immersion (at King Open)</a></li>
	      <li><a class="external" href="#peabody">Peabody</a></li>
	      <li><a class="external" href="#tobin">Tobin Montessori</a></li>
	    </ul>
	  </li>
	  <li class="nav-top-tab" id="choose-tab"><a href="#choose">How to Choose</a></li>
	  <li class="nav-top-tab" id="lottery-tab"><a href="#lottery">Lottery</a></li>
	  <li class="nav-top-tab" id="language-tab"><a href="#language">Immersion</a></li>
	  <li class="nav-top-tab" id="contactus-tab"><a href="#contactus">Contact Us</a></li>
	  <!--li class=""><a href="/three-year-old">3 Year-Olds</a></li-->
	</ul>
      </nav>
    </div>
    <div class="container" id="main-page-container">
    
    </div>

    <script src="lib/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="lib/showdown.min.js" type="text/javascript"></script>
    <script src="lib/js-yaml.js"></script>
    <script src="lib/handlebars.min.js"></script>
    <script src="lib/bootstrap.min.js"></script>

    <script id="school-template"  type="text/x-handlebars-template">
      <div class="overview">
	<h1>{{Name}}</h1>
	<!--<p> At a glance: </p> -->
	<ul>
	  <li> Location: <a href="https://www.google.com/maps/place/{{Address}}">{{Address}}</a> </li>
	  <li> <a href="{{Web}}">School Web Site</a>
	  <li> <a href="http://profiles.doe.mass.edu/general/general.aspx?topNavID=1&leftNavId=100&orgcode={{Code}}&orgtypecode=6">Massachusetts School Stats</a>
	  <li> <a href="{{sip}}">School Improvement Plan</a></li>
	  <li> PTO: <a href="{{pto-url}}">{{pto}}</a> </li>
	  <li> School hours: {{school-hours}}
	</ul>
      </div>

      <div id="schoolinfo">
      </div>

      <div id="schooldemographics">
      </div>

    </script>

    <script id="index-template"  type="text/x-handlebars-template">
      <h1> The Unofficial Guide to School Choices for the Cambridge Kindergarten Lottery</h1>
      <p><i> Disclaimer: this site is by parents for parents. A group of us CPS parents, having gone through the lottery, want to share learnings to make it easier for new parents.  For official info, refer to <a target="_blank" href="http://www.cpsd.us/departments/frc/registering_for/january_kindergarten_lottery">CPSD site</a>.</i> This site is unfinished.</p>


      <br/><br/>

      <table border=1 cellspacing=0 cellpadding="4">
	<tr>
          <td>Elementary School (K-5)</td><td>Upper School(6-8)</td><td>High School (9-12)</td>
	</tr>
	
	<tr>
	  <td colspan="2"><a href="#amigos" >Amigos</a> (Spanish Immersion)</td>
	  <td rowspan="14">CRLS</td>
	</tr>
 
	<tr><td><a href="#klo">Kennedy-Longfellow</a></td><td rowspan="4">Putnam Ave</td></tr>
	<tr><td><a href="#morse">Morse</a></td></tr>
	<tr><td><a href="#mlk">Dr. MLK</a></td> </tr>
	<tr><td><a href="#mlk-ci">Chinese Immersion (at Dr. MLK)</a></td></tr>
	
	<tr><td><a href="#baldwin">Baldwin</a></td><td rowspan="2">Rindge Ave</td> </tr>
	<tr><td><a href="#peabody">Peabody</a></td></tr>

	<tr><td><a href="#tobin">Tobin Montessori</a></td><td rowspan="3">Vassal Lane</td></tr>
	<tr><td><a href="#grahamandparks">Graham and Parks</a></td></tr>
	<tr><td><a href="#haggerty">Haggerty</a></td></tr>
      
	<tr><td><a href="#fma" >FMA</a></td><td rowspan="4">Cambridge St.</td></tr>
	<tr><td><a href="#kingopen">King Open</a></td></tr>
	<tr><td><a href="#kingopen-ola">Ola Portugese Immersion (at King Open)</a></td></tr>
	<tr><td><a href="#cambridgeport">Cambridgeport</a></td></tr>
      </table>
      <br/>
      <br/>
      <p>Map of schools</p>
      <a target="_blank" href="img/cambridgeSchools.png"><img style=1 src="img/schoolsMapSm.png"/>
	<br/>
	<!--<i>Click to zoom in new window.</i>-->
      </a>
    </script>

    
    <script type="text/javascript">
      var converter = new showdown.Converter();
      var school_info = null;
      var template = Handlebars.compile($("#school-template").html());

      static_pages = {
        'choose': {"title": "How to Choose a School"},
        'lottery': {"title": "CPS Lottery De-Mystified"},
        'language': {"title": "Immersion/World Language"},
        'contactus': {"title": "Contact Us"}
      };

      function refresh() {
          var page_location = window.location.hash.substring(1);

          /* Redirect / to be the same as #index */
          if (page_location == "") {
             page_location = "index";
          }

          /* Blank top menu if we're switching pages */
          $(".nav-top-tab").removeClass("active");

          /**********************************
           * Router/code for specific pages *
           **********************************/
      
          /* For the main index, just use the static HTML we've got */
          if (page_location == "index") {
             $("#main-page-container").html($("#index-template").html());
             $("#home-tab").addClass("active");
          }

          /* For the school info, we need to make sure we've loaded the school info. If not, we just display "Loading...."
      
             If so, we render the main page as a template of info on the current school, load in the markdown for the
             overview, and show the image of the school demographics (which are loaded into divs from the template.
          */
          if (school_info && school_info[page_location] ) {
             if ( school_info == null ) {
                $("#index-template").html('Loading...');
                return;
             }
             $("#main-page-container").html(template(school_info[page_location]));
             $("#schooldemographics").html('<img src="img/'+page_location+'.png"/>');
             $.ajax({url: "schools/"+page_location+".md"}).done(function( data ) {
                var html = converter.makeHtml(data);
                $("#schoolinfo").html(html);
             });
             $("#school-tab").addClass("active");
          };

          /*
          And for static pages, we just load a div with the markdown.
          */
          if (static_pages[page_location]) {
             $.ajax({url: page_location+".md"}).done(function( data ) {
                var html = converter.makeHtml(data);
                $("#main-page-container").html(html);
             });
             $("#"+page_location+"-tab").addClass("active");
          }
      }

      $(function() {
         $("#schoolinfo").html("Loading...");
         window.onhashchange = refresh;

         $.ajax({url: "schools.yaml"}).done(function( data ) {
            school_info = jsyaml.safeLoad(data);
            refresh();
         });
      
         refresh();
      });
    </script>
    <hr/>
    <center> Questions? Feedback? <a href="#contactus">Contact us.</a></center>
    <br/>
  </body>
</html>
